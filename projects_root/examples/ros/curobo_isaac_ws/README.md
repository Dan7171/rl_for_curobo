# CuRobo Isaac-Sim + ROS 2 Workspace

This folder hosts **two** pieces that talk to each other via the Isaac-Sim ROS 2 bridge:

1. `curobo_multirobot_graph.py` ‚Äì Python helper that, when imported inside an Isaac-Sim script, builds an OmniGraph which publishes every robot's MPC plan on a unique ROS 2 topic (`/robot_<id>/plan`).  No `rclpy` is used; the bridge handles DDS serialization.
2. `ros_ws/` ‚Äì A standard ROS 2 (Jazzy) workspace that contains optional helper nodes, e.g. the `plan_listener` that prints incoming plans.

## Prerequisites
‚Ä¢ Isaac-Sim 5.0 in the **`isaac-sim` conda environment** (Python 3.11).  
‚Ä¢ System-wide ROS 2 Jazzy (Python 3.12).

Keep the two Python versions separate ‚Äì they communicate over DDS, not via shared libraries.

## 1  Build the ROS workspace (only once)
```bash
# Terminal A ‚Äì ROS environment (Python 3.12)
cd projects_root/examples/ros/curobo_isaac_ws/ros_ws
source /opt/ros/jazzy/setup.bash
colcon build --symlink-install
source install/setup.bash
# optional env so it matches Isaac-Sim
export RMW_IMPLEMENTATION=rmw_fastrtps_cpp
export ROS_DOMAIN_ID=0
```
Run the demo listener:
```bash
ros2 run curobo_ros_workspace plan_listener
```

## 2  Launch Isaac-Sim with CuRobo
```bash
# Terminal B ‚Äì Isaac-Sim (Python 3.11)
conda activate isaac-sim
export RMW_IMPLEMENTATION=rmw_fastrtps_cpp
export ROS_DOMAIN_ID=0

python my_multirobot_script.py   # your MPC demo
```
Inside your script:
```python
from curobo_multirobot_graph import build_plan_publish_graph, push_plan

graph = build_plan_publish_graph(robot_ids=[0,1,2])
...
json_plan = planner.get_plan_json()
push_plan(robot_id, json_plan)   # call every control step
```
The listener in Terminal A will print the first waypoint of each plan, proving data flows over ROS 2.

## File layout
```
curobo_isaac_ws/
‚îú‚îÄ curobo_multirobot_graph.py   ‚Üê Isaac-side helper
‚îî‚îÄ ros_ws/                      ‚Üê ROS workspace
   ‚îî‚îÄ src/curobo_ros_workspace/  (package)
      ‚îú‚îÄ package.xml
      ‚îú‚îÄ setup.py
      ‚îî‚îÄ curobo_ros_workspace/
         ‚îî‚îÄ plan_listener.py
```
`ros_ws/build`, `ros_ws/install`, `ros_ws/log` are generated by `colcon build` and can be deleted anytime.

## Custom nodes or messages
Add new Python nodes under `ros_ws/src/curobo_ros_workspace/` and rebuild with `colcon build`.  If you ever need a custom message type, place the `.msg` file there and switch Isaac-Sim to use `ROS2PublishRaw`.

Happy experimenting! üöÄ 